<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <title>ACME BANK</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f2f2f2;
            display: flex;
            justify-content: center;
            padding: 20px;
        }


        .container {
            background-color: white;
            border-radius: 20px;
            padding: 30px 20px;
            width: 550px;
            height: 700px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }


        .logo {
            text-align: center;
            margin-bottom: 20px;
        }


        .logo img {
            width: 150px;
        }


        h1 {
            text-align: center;
            font-size: 22px;
            margin-bottom: 20px;
        }


        form {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }


        input,
        select,
        button {
            padding: 10px;
            border-radius: 12px;
            border: none;
            font-size: 14px;
        }


        input::placeholder {
            color: white;
        }


        input,
        select {
            background-color: #007bff;
            color: white;
            text-align: center;
        }


        button {
            background-color: blue;
            color: white;
            font-weight: bold;
            cursor: pointer;
        }


        button.cancelar {
            background-color: purple;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="logo">
            <img src="/Static/img/d52f977512.png" alt="Logo">
        </div>


        <form id="formUsuario">
            <input type="text" id="nombre" placeholder="NOMBRE" required />
            <input type="text" id="apellidos" placeholder="APELLIDOS" required />


            <select id="tipoId" required>
                <option value="">TIPO DE IDENTIFICACION</option>
                <option value="CC">CC</option>
                <option value="TI">TI</option>
                <option value="CE">CE</option>
            </select>


            <input type="text" id="identificacion" placeholder="IDENTIFICACION" required />


            <select id="genero" required>
                <option value="">GENERO</option>
                <option value="Masculino">Masculino</option>
                <option value="Femenino">Femenino</option>
                <option value="Otro">Otro</option>
            </select>


            <input type="tel" id="telefono" placeholder="TELEFONO" required />
            <input type="email" id="correo" placeholder="CORREO ELECTRONICO" required />
            <input type="text" id="direccion" placeholder="DIRECCION" required />
            <input type="password" id="contrasena" placeholder="CONTRASE√ëA" required />
            <input type="password" id="confirmarContrasena" placeholder="CONFIRMAR CONTRASE√ëA" required />

            <button type="submit">ENVIAR</button>

            <a href="/Temples/inicio.html"><button type="button" class="cancelar">CANCELAR</button></a>
        </form>
    </div>


    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
        import { getFirestore, setDoc, doc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAyVF_iOgpDKTQco5Y9ZqmURB0YAd6TMhs",
            authDomain: "acme-bank-a0686.firebaseapp.com",
            projectId: "acme-bank-a0686",
            storageBucket: "acme-bank-a0686.firebasestorage.app",
            messagingSenderId: "302724149232",
            appId: "1:302724149232:web:9a84221b967416e2933735"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const form = document.getElementById("formUsuario");

        // üî¢ Funci√≥n para generar n√∫mero de cuenta aleatorio
        function generarNumeroCuenta() {
            const prefijo = "41";
            const numeroAleatorio = Math.floor(100000000 + Math.random() * 900000000);
            return prefijo + numeroAleatorio;
        }

        form.addEventListener("submit", async (e) => {
            e.preventDefault();

            const nombre = document.getElementById("nombre").value;
            const apellidos = document.getElementById("apellidos").value;
            const tipoId = document.getElementById("tipoId").value;
            const identificacion = document.getElementById("identificacion").value;
            const genero = document.getElementById("genero").value;
            const telefono = document.getElementById("telefono").value;
            const correo = document.getElementById("correo").value;
            const direccion = document.getElementById("direccion").value;
            const contrasena = document.getElementById("contrasena").value;
            const confirmarContrasena = document.getElementById("confirmarContrasena").value;

            if (contrasena !== confirmarContrasena) {
                alert("‚ùå Las contrase√±as no coinciden.");
                return;
            }

            const numeroCuenta = Math.floor(100000000 + Math.random() * 900000000).toString();

            try {
                await setDoc(doc(db, "usuarios", identificacion), {
                    nombre,
                    apellidos,
                    tipoId,
                    identificacion,
                    genero,
                    telefono,
                    correo,
                    direccion,
                    contrasena,
                    numeroCuenta,
                    creado: new Date().toISOString()
                });

                localStorage.setItem("idUsuario", identificacion);
                localStorage.setItem("nombreUsuario", nombre + " " + apellidos);
                localStorage.setItem("numeroCuenta", numeroCuenta);
                window.location.href = "iniciodesesion.html";

            } catch (error) {
                console.error("‚ùå Error al guardar:", error);
                alert("Hubo un error al registrar el usuario.");
            }
        });
    </script>
</body>

</html>